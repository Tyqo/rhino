{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["/**\n * src/js/main.js\n *\n * Main javascript file\n *\n * @author Johannes Braun <j.braun@agentur-halma.de>\n * @author Carsten Coull <c.coull@agentur-halma.de>\n * @package halma-kickstart\n * @version 2021-05-28\n */\n\n/**\n * Import modules, modules are stored in `src/js/modules/`\n */\nimport Nav from \"./vendor/nav.js\";\nimport FlashMessages from \"./vendor/flash-messages.js\";\nimport LightBox from \"./vendor/light-box.js\";\nimport Overlay from \"./vendor/overlay.js\";\n// import LazyLoading from \"/js/vendor/lazyload.js\";\n// import Map from \"/js/vendor/map.js\";\n// import Slider from \"/js/vendor/slider.js\";\n\n\n/**\n * Application main class\n */\nclass MAIN {\n\t/**\n\t * Constructor\n\t */\n\tconstructor() {\n\t\t// Class properties, can only be declared inside a method … :-(\n\t\tthis.debug = false;\n\t\tdocument.addEventListener(\"DOMContentLoaded\", () => this.init());\n\t\twindow.onload = () => this.pageInit();\n\t}\n\n\t/**\n\t * init\n\t * Called on DOMContentLoaded, so a good place to setup things not dependend\n\t * on the page finished rendering\n\t */\n\tinit() {\n\t\tif (this.debug) {\n\t\t\tconsole.debug(\"MAIN::init\");\n\t\t}\n\n\t\tdocument.body.classList.add(\"page-has-loaded\");\n\n\t\t// get scrollbar width to be able to use .full-width\n\t\t// @see https://destroytoday.com/blog/100vw-and-the-horizontal-overflow-you-probably-didnt-know-about\n\t\tconst scrollbarWidth = window.innerWidth - document.body.clientWidth;\n\t\tdocument.body.style.setProperty(\"--scrollbarWidth\", scrollbarWidth + \"px\");\n\n\t\twindow.addEventListener(\"resize\", () => this.throttle(this.resizeHandler), { passive: true });\n\t\twindow.addEventListener(\"scroll\", () => this.throttle(this.scrollHandler), { passive: true });\n\t}\n\n\t/**\n\t * pageInit\n\t * Called on window.load, i.e. when the page and all assets have been\n\t * loaded completely and the page has rendered\n\t *\n\t * @return void\n\t */\n\tpageInit() {\n\t\tif (this.debug) {\n\t\t\tconsole.debug(\"MAIN::pageInit\");\n\t\t}\n\n\t\tdocument.body.classList.add(\"page-has-rendered\");\n\n\t\t// Let's see if we have a header element and get it's height (for\n\t\t// detecting scroll past header, see `App.scrollHandler`\n\t\tthis.header = document.querySelector(\"header\");\n\t\tif (this.header) {\n\t\t\tlet rect = this.header.getBoundingClientRect();\n\t\t\tthis.headerBottom = rect.top + rect.height;\n\t\t}\n\n\t\tthis.main();\n\t}\n\n\t/**\n\t * Main method\n\t * Put main business logic here\n\t *\n\t * @return void\n\t */\n\tmain() {\n\t\tthis.Nav = new Nav(this);\n\t\t\n\t\tthis.FlashMessages = new FlashMessages(this);\n\n\t\tthis.Overlay = new Overlay(this, {\n\t\t\tcloseButtonIcon: '/tusk/icon/cross.svg',\n\t\t\tcloseButtonTitle: 'Close Overlay'\n\t\t});\n\n\t\t// this.Slider = new Slider(this);\n\t\tthis.LightBox = new LightBox(this, {\n\t\t\tselector: '#main img',\n\t\t\tprevTitle: 'zum vorherigem Bild',\n\t\t\tnextTitle: 'zum nächsten Bild',\n\t\t\tprevIcon: '/dist/icons/chevron-left.svg',\n\t\t\tnextIcon: '/dist/icons/chevron-right.svg'\n\t\t});\n\t}\n\n\t/*\n\t * Debounced / throttled scroll handler. Put your scroll-related stuff here!\n\t * @return void\n\t */\n\tscrollHandler() {\n\t\tlet y = window.scrollY;\n\n\t\tif (this.debug) {\n\t\t\tconsole.debug(`Scroll position: ${y}`);\n\t\t}\n\n\t\t// Set classes on body depending on how far the page has scrolled\n\t\tdocument.body.classList.toggle(\"has-scrolled\", y > 0);\n\t\tdocument.body.classList.toggle(\"has-scrolled-a-bit\", y > 30);\n\t\tdocument.body.classList.toggle(\n\t\t\t\"has-scrolled-past-header\",\n\t\t\ty > this.headerBottom\n\t\t);\n\t\tdocument.body.classList.toggle(\n\t\t\t\"has-scrolled-100vh\",\n\t\t\ty > window.innerHeight\n\t\t);\n\n\t\t// Todo: Scroll direction!\n\t\tif (this.lastScrollPosition) {\n\t\t\tdocument.body.classList.toggle(\n\t\t\t\t\"has-scrolled-up\",\n\t\t\t\ty < this.lastScrollPosition\n\t\t\t);\n\n\t\t\tdocument.body.classList.toggle(\n\t\t\t\t\"has-scrolled-down\",\n\t\t\t\ty > this.lastScrollPosition\n\t\t\t);\n\t\t}\n\t\tthis.lastScrollPosition = y;\n\n\t\t// Extend here …\n\t}\n\n\t/**\n\t * Debounced / throttled scroll handler. Put your resize-related stuff here!\n\t *\n\t * @return void\n\t */\n\tresizeHandler() {\n\t\tlet width = window.innerWidth,\n\t\t\theight = window.innerHeight;\n\n\t\tif (this.debug) {\n\t\t\tconsole.debug(`Window has been resized to ${width}, ${height}`);\n\t\t}\n\n\t\t// Set custom properties\n\t\tdocument.body.style.setProperty(\"--window-width\", `${width}px`);\n\t\tdocument.body.style.setProperty(\"--window-height\", `${height}px`);\n\n\t\t// Extend here …\n\t}\n\n\t/**\n\t * Throttler method\n\t *\n\t * @param callable: Handler to be called on throttled scroll event\n\t * @return void\n\t */\n\tthrottle(handler) {\n\t\tthis.ticking = false;\n\n\t\tif (!this.ticking) {\n\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\thandler.call(this);\n\t\t\t\tthis.ticking = false;\n\t\t\t});\n\t\t\tthis.ticking = true;\n\t\t}\n\t}\n\n\t/**\n\t * execute if click/interaktion is outside of the Selector\n\t *\n\t * @param selector: Element selector (e.g. class, id) to watch for\n\t * @param callback: function to execute if interaktion is outside of the Selector\n\t *\n\t * Example:\n\t * this.app.onOutsideClick('#main-menu', this.closeMenu);\n\t */\n\tonOutsideClick(selector, callback) {\n\t\tdocument.addEventListener(\"click\", (event) => {\n\t\t\tvar target = event.target.parentNode.closest(selector);\n\t\t\tif (target == null && document.querySelector(selector) != event.target) {\n\t\t\t\tcallback(event, target);\n\t\t\t}\n\t\t});\n\t}\n\n\thideElement() {\n\n\t}\n}\n\nnew MAIN();\n"],"file":"main.js"}